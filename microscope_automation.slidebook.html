
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>microscope_automation.slidebook package &#8212; Microscope Automation 0.0 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="microscope_automation.zeiss package" href="microscope_automation.zeiss.html" />
    <link rel="prev" title="microscope_automation.samples package" href="microscope_automation.samples.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="microscope-automation-slidebook-package">
<h1>microscope_automation.slidebook package<a class="headerlink" href="#microscope-automation-slidebook-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-microscope_automation.slidebook.connect_slidebook">
<span id="microscope-automation-slidebook-connect-slidebook-module"></span><h2>microscope_automation.slidebook.connect_slidebook module<a class="headerlink" href="#module-microscope_automation.slidebook.connect_slidebook" title="Permalink to this headline">¶</a></h2>
<p>Communication layer for 3i Slidebook
This layer sends http commands to a command and data servers.
Slidebook calls a MatLab library that pulls the commands from the server queue</p>
<p>Date Created: January 26, 2020</p>
<dl class="py class">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope">
<em class="property">class </em><code class="sig-prename descclassname">microscope_automation.slidebook.connect_slidebook.</code><code class="sig-name descname">ConnectMicroscope</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cmd_url</span><span class="o">=</span><span class="default_value">'http://127.0.0.1:5000'</span></em>, <em class="sig-param"><span class="n">data_url</span><span class="o">=</span><span class="default_value">'http://127.0.0.1:5100'</span></em>, <em class="sig-param"><span class="n">microscope</span><span class="o">=</span><span class="default_value">'3iW1-0'</span></em>, <em class="sig-param"><span class="n">dummy</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.clear_experiments">
<code class="sig-name descname">clear_experiments</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.clear_experiments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.clear_experiments" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear experiments queue</p>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.count_experiments">
<code class="sig-name descname">count_experiments</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.count_experiments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.count_experiments" title="Permalink to this definition">¶</a></dt>
<dd><p>Return number of experiments inqueue</p>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.create_experiment_path">
<code class="sig-name descname">create_experiment_path</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment</span></em>, <em class="sig-param"><span class="n">experiment_folder</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.create_experiment_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.create_experiment_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates complete path to capture settings.
Raises exception if experiment does not exist.</p>
<dl>
<dt>Input:</dt><dd><p>experiment: string with name of capture settings
(with or w/o extension .exp.prefs)</p>
<p>experiment_folder: folder for capture settings</p>
</dd>
<dt>Output:</dt><dd><p>experiment_path: path to experiment</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.delete_experiment">
<code class="sig-name descname">delete_experiment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.delete_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.delete_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete experiment by id</p>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.execute_experiment">
<code class="sig-name descname">execute_experiment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">capture_settings</span></em>, <em class="sig-param"><span class="n">locations</span></em>, <em class="sig-param"><span class="n">objective</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.execute_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.execute_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute experiments with parameters defined in experiment
on multiple positions.</p>
<dl>
<dt>Input:</dt><dd><p>capture_settings: string with name of experiment as defined within
Microscope software</p>
<p>objective: objective used to acquire image. If none keep objective.</p>
<p>locations: list with (x,y,z) stage locations</p>
</dd>
<dt>Output:</dt><dd><p>success: True when experiment was successfully posted on command server</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_about_command_service">
<code class="sig-name descname">get_about_command_service</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.get_about_command_service"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_about_command_service" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve information about command service</p>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_about_data_service">
<code class="sig-name descname">get_about_data_service</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.get_about_data_service"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_about_data_service" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve information about data service</p>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_experiment">
<code class="sig-name descname">get_experiment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.get_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Return experiment by id</p>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_experiment_dict">
<code class="sig-name descname">get_experiment_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.get_experiment_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_experiment_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve dictionary with all experiments on queue</p>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_focus_pos">
<code class="sig-name descname">get_focus_pos</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.get_focus_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_focus_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return current position of focus drive.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>none</p>
</dd>
<dt>Output:</dt><dd><p>zPos: position of focus drive in micrometer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_focus_settings">
<code class="sig-name descname">get_focus_settings</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">experiment_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.get_focus_settings"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_focus_settings" title="Permalink to this definition">¶</a></dt>
<dd><p>Get focus settings.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl>
<dt>Input:</dt><dd><p>experiment_path: path of the experiment file</p>
<p>experiment_name: name of the experiment</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_microscope_name">
<code class="sig-name descname">get_microscope_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.get_microscope_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_microscope_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns name of the microscope from hardware that is controlled by this class</p>
<dl class="simple">
<dt>Input:</dt><dd><p>none</p>
</dd>
<dt>Output:</dt><dd><p>Microscope: name of Microscope</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_next_experiment">
<code class="sig-name descname">get_next_experiment</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.get_next_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_next_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Return next (oldest) experiments in queue</p>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_objective_position_from_experiment_file">
<code class="sig-name descname">get_objective_position_from_experiment_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">experiment_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.get_objective_position_from_experiment_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_objective_position_from_experiment_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get the position of the objective used in the experiment
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl>
<dt>Input:</dt><dd><p>experiment_path: path of the experiment file</p>
<p>experiment_name: name of the experiment</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_stage_pos">
<code class="sig-name descname">get_stage_pos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">repetitions</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">wait</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.get_stage_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.get_stage_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return most recent position of Microscope stage.</p>
<dl>
<dt>Input:</dt><dd><p>repetitions: number of times to try to get a response</p>
<p>wait: wait time per repetition in sec</p>
</dd>
<dt>Output:</dt><dd><p>xPos, yPos, zPos: x and y position of stage in micrometer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.is_tile_scan">
<code class="sig-name descname">is_tile_scan</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">experiment_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.is_tile_scan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.is_tile_scan" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to check if the experiment is a tile scan.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl>
<dt>Input:</dt><dd><p>experiment_path: path of the experiment file</p>
<p>experiment_name: name of the experiment</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.is_z_stack">
<code class="sig-name descname">is_z_stack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">experiment_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.is_z_stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.is_z_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to check if the experiment contains z-stack acquisition.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl>
<dt>Input:</dt><dd><p>experiment_path: path of the experiment file</p>
<p>experiment_name: name of the experiment</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.live_mode_start">
<code class="sig-name descname">live_mode_start</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.live_mode_start"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.live_mode_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Start live mode.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>experiment: name of experiment</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.live_mode_stop">
<code class="sig-name descname">live_mode_stop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.live_mode_stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.live_mode_stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop live mode.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>experiment: name of experiment</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.load_image">
<code class="sig-name descname">load_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">get_meta_data</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.load_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.load_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Load most recent image from data service and return it a class ImageAICS</p>
<dl>
<dt>Input:</dt><dd><p>image: image object of class ImageAICS.</p>
<p>get_meta: if true, retrieve meta data from file. Default is False</p>
</dd>
<dt>Output:</dt><dd><p>image: image with data and meta data as ImageAICS class</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.move_focus_to">
<code class="sig-name descname">move_focus_to</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">zPos</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.move_focus_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.move_focus_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Move focus to new position.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>zPos, yPos: new focus position in micrometers.</p>
</dd>
<dt>Output:</dt><dd><p>zFocus: new position of focus drive</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.move_focus_to_load">
<code class="sig-name descname">move_focus_to_load</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.move_focus_to_load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.move_focus_to_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Move focus to load position if defined.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>zPos, yPos: new focus position in micrometers.</p>
</dd>
<dt>Output:</dt><dd><p>zFocus: new position of focus drive</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.move_focus_to_work">
<code class="sig-name descname">move_focus_to_work</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.move_focus_to_work"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.move_focus_to_work" title="Permalink to this definition">¶</a></dt>
<dd><p>Move focus to work position if defined.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>zPos, yPos: new focus position in micrometers.</p>
</dd>
<dt>Output:</dt><dd><p>zFocus: new position of focus drive</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.move_stage_to">
<code class="sig-name descname">move_stage_to</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xPos</span></em>, <em class="sig-param"><span class="n">yPos</span></em>, <em class="sig-param"><span class="n">zPos</span></em>, <em class="sig-param"><span class="n">capture_settings</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">test</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.move_stage_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.move_stage_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Move stage to new position.</p>
<dl>
<dt>Input:</dt><dd><p>xPos, yPos, zPos: new stage and objective position in micrometers.</p>
<p>capture_settings: capture settings in Slidebook Capture dialog to move stage</p>
<p>test: not used but included for consistency with ZEN Blue API</p>
</dd>
<dt>Output:</dt><dd><p>xPos, yPos, zPos: new stage and objective position in micrometers</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.not_implemented">
<code class="sig-name descname">not_implemented</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.not_implemented"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.not_implemented" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise exception if method is not implemented.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>method_name: method that calls this method</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.post_experiment">
<code class="sig-name descname">post_experiment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.post_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.post_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Post experiment as last entry on queue and return updated experiment</p>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.remove_all">
<code class="sig-name descname">remove_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.remove_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.remove_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all images from queue at data service.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>none</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.save_image">
<code class="sig-name descname">save_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fileName</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.save_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.save_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Save last acquired ImageAICS in original file format
using microscope software</p>
<p>Raises HardwareCommandNotDefinedError</p>
<dl class="simple">
<dt>Input:</dt><dd><p>file: file name and path for ImageAICS save</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.set_focus_load_position">
<code class="sig-name descname">set_focus_load_position</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.set_focus_load_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.set_focus_load_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve current position and set as load position.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>none</p>
</dd>
<dt>Output:</dt><dd><p>zLoad: current focus position in mum</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.set_focus_work_position">
<code class="sig-name descname">set_focus_work_position</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.set_focus_work_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.set_focus_work_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve current position and set as work position.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>none</p>
</dd>
<dt>Output:</dt><dd><p>z_work: current focus position in mum</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.snap_image">
<code class="sig-name descname">snap_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">capture_settings</span></em>, <em class="sig-param"><span class="n">objective</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.snap_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.snap_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Snap image with parameters defined in experiment at current location.
Raise exception if request was not successful</p>
<dl>
<dt>Input:</dt><dd><p>capture_settings: string with name of capture_settings as defined
within Microscope software</p>
<p>objective: objective used to acquire image. If none keep objective.</p>
</dd>
<dt>Return:</dt><dd><p>response: Return dictionary with response from commands microservice</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.stop">
<code class="sig-name descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop Microscope immediately</p>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.trigger_pump">
<code class="sig-name descname">trigger_pump</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seconds</span></em>, <em class="sig-param"><span class="n">port</span><span class="o">=</span><span class="default_value">'COM1'</span></em>, <em class="sig-param"><span class="n">baudrate</span><span class="o">=</span><span class="default_value">19200</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.trigger_pump"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.trigger_pump" title="Permalink to this definition">¶</a></dt>
<dd><p>Trigger pump</p>
<dl>
<dt>Input:</dt><dd><p>seconds: the number of seconds pump is activated</p>
<p>port: com port, default = ‘COM1’</p>
<p>baudrate: baudrate for connection, can be set on pump, typically = 19200</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.update_tile_positions">
<code class="sig-name descname">update_tile_positions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_path</span></em>, <em class="sig-param"><span class="n">experiment_name</span></em>, <em class="sig-param"><span class="n">x_value</span></em>, <em class="sig-param"><span class="n">y_value</span></em>, <em class="sig-param"><span class="n">z_value</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.update_tile_positions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.update_tile_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to define the position of the tile.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl>
<dt>Input:</dt><dd><p>experiment_path: path of the experiment file</p>
<p>experiment_name: name of the experiment</p>
<p>x_value: float (x - coordinate)</p>
<p>y_value: float (y - coordinate)</p>
<p>z_value: float (z - coordinate)</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.validate_experiment">
<code class="sig-name descname">validate_experiment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">experiment_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.validate_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.validate_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to check if the experiment is defined in the Slidebook software</p>
<dl>
<dt>Input:</dt><dd><p>experiment_path: path of the experiment file - does not matter for Zen Black</p>
<p>experiment_name: name of the experiment</p>
</dd>
<dt>Output:</dt><dd><p>valid_experiment: bool describing if the experiment is valid</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.z_down_relative">
<code class="sig-name descname">z_down_relative</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.z_down_relative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.z_down_relative" title="Permalink to this definition">¶</a></dt>
<dd><p>Move focus relative to current position away from sample.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>delta: absolute distance in mum</p>
</dd>
<dt>Output:</dt><dd><p>z: new position of focus drive</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.z_relative_move">
<code class="sig-name descname">z_relative_move</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.z_relative_move"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.z_relative_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Move focus relative to current position.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>delta: distance in mum</p>
</dd>
<dt>Output:</dt><dd><p>z: new position of focus drive</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.z_stack_range">
<code class="sig-name descname">z_stack_range</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">experiment_name</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.z_stack_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.z_stack_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to  get the range of first z-stack in experiment.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl>
<dt>Input:</dt><dd><p>experiment_path: path of the experiment file</p>
<p>experiment_name: name of the experiment</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.z_up_relative">
<code class="sig-name descname">z_up_relative</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delta</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#ConnectMicroscope.z_up_relative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.ConnectMicroscope.z_up_relative" title="Permalink to this definition">¶</a></dt>
<dd><p>Move focus relative to current position towards sample.
Included for parity between Microscope connections.</p>
<p>Raises HardwareCommandNotDefinedError.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>delta: absolute distance in mum</p>
</dd>
<dt>Output:</dt><dd><p>z: new position of focus drive</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="microscope_automation.slidebook.connect_slidebook.show_image">
<code class="sig-prename descclassname">microscope_automation.slidebook.connect_slidebook.</code><code class="sig-name descname">show_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">meta_data</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/connect_slidebook.html#show_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.connect_slidebook.show_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Show image</p>
</dd></dl>

</div>
<div class="section" id="module-microscope_automation.slidebook.hardware_control_3i">
<span id="microscope-automation-slidebook-hardware-control-3i-module"></span><h2>microscope_automation.slidebook.hardware_control_3i module<a class="headerlink" href="#module-microscope_automation.slidebook.hardware_control_3i" title="Permalink to this headline">¶</a></h2>
<p>Classes to describe and control 3i spinning disk hardware.
Bridge between automation software and hardware specific implementations.
Created on Jul 7, 2016
Split into hardware_control and hardware_components on May 25, 2020
Split into hardware_control and hardware_control_3i on Aug. 15, 2020 by Winfried</p>
<p>&#64;author: winfriedw</p>
<dl class="py class">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i">
<em class="property">class </em><code class="sig-prename descclassname">microscope_automation.slidebook.hardware_control_3i.</code><code class="sig-name descname">SpinningDisk3i</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">control_software_object</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">experiments_folder</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">microscope_components</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="microscope_automation.hardware.html#microscope_automation.hardware.hardware_control.BaseMicroscope" title="microscope_automation.hardware.hardware_control.BaseMicroscope"><code class="xref py py-class docutils literal notranslate"><span class="pre">microscope_automation.hardware.hardware_control.BaseMicroscope</span></code></a></p>
<p>Collection class to describe and operate 3i spinning disk microscope</p>
<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.create_experiment_path">
<code class="sig-name descname">create_experiment_path</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.create_experiment_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.create_experiment_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates complete path to capture settings (Slidebook).
Raises exception if experiment does not exist.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>experiment: string with name of capture settings
(with or w/o extension .exp.prefs)</p>
</dd>
<dt>Output:</dt><dd><p>experiment_path: path to experiment or capture settings</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.execute_experiment">
<code class="sig-name descname">execute_experiment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">capture_settings</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">file_path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">position_list</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">interactive</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.execute_experiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.execute_experiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Trigger microscope to execute experiment defined within vendor software.
Class ImageAICS is a container for meta and image data.
To add image data use method load_image.
Do not try to recover from exceptions on this level.</p>
<dl>
<dt>Input:</dt><dd><p>capture_settings: string or list of strings with names of capture settings
as defined within 3i Slidebook software. If one capture setting is provided
execute same settings at all positions. If list with capture settings is
provided, execute each setting on each position. The number of positions
has to be identical as the number of capture strings.</p>
<p>file_path: string with path to save image to. Do not save if None (default)</p>
<p>position_list: list with stage coordinates for images</p>
<p>interactive: if True, allow user to modify file name if file exists</p>
</dd>
<dt>Output:</dt><dd><p>image: image of class ImageAICS to hold metadata.
Does not contain image data at this moment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.get_information">
<code class="sig-name descname">get_information</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">components_list</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.get_information"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.get_information" title="Permalink to this definition">¶</a></dt>
<dd><p>Get positions for hardware components.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>components_list: list with names of components to retrieve positions
Default: None = get positions for all components</p>
</dd>
<dt>Output:</dt><dd><p>positions_dict: dictionary {component_id: positions}.
Positions are dictionaries if multiple positions can be retrieved</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.get_z_position">
<code class="sig-name descname">get_z_position</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">focus_drive_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">auto_focus_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">force_recall_focus</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">trials</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">reference_object_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.get_z_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.get_z_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Get current position of focus drive.</p>
<dl>
<dt>Input:</dt><dd><p>focus_drive_id: string id for focus drive to get the position for</p>
<p>auto_focus_id: string id for auto focus to use (None: do not use auto-focus)</p>
<p>force_recall_focus: if True, recall focus, otherwise use old values.
Default: False</p>
<p>trials: number of trials to retrieve z position before procedure is aborted</p>
<p>reference_object_id: ID of object of Sample class used to correct for
xyz offset between different objectives</p>
<p>verbose: if True, print debug messages (Default: False)</p>
</dd>
<dt>Output:</dt><dd><dl>
<dt>positions_dict: dictionary {component_id: positions}.</dt><dd><p>positions are dictionaries with</p>
<blockquote>
<div><p>‘absolute’: absolute position of focus drive as shown
in software</p>
<p>‘z_focus_offset’: parfocality offset</p>
<p>‘focality_corrected’: absolute focus position -
z_focus_offset</p>
<p>‘auto_focus_offset’: change in autofocus position</p>
<p>‘focality_drift_corrected’: focality_corrected position -
auto_focus_offset</p>
<p>‘load_position’: load position of focus drive</p>
<p>‘work_position’: work position of focus drive</p>
</div></blockquote>
<p>with focus positions in um</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.initialize_hardware">
<code class="sig-name descname">initialize_hardware</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">initialize_components_ordered_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reference_object_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">trials</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.initialize_hardware"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.initialize_hardware" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize all hardware components.</p>
<dl>
<dt>Input:</dt><dd><p>component_OrderedDict: directory with names of components to initialize
and list of initialization steps. Default: None = initialize all
components in order as assigned to microscope object</p>
<p>reference_object_id: Used for setting up of autofocus</p>
<p>trials: number of trials before initialization is aborted</p>
<p>verbose: if True print debug information (Default = True)</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.load_image">
<code class="sig-name descname">load_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">get_meta</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.load_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.load_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Load image and return it as class ImageAICS.
Methods ads image and meta data to image.
Methods passes load image to microscope specific load method.</p>
<dl>
<dt>Input:</dt><dd><p>communication_object: Object that connects to microscope specific software</p>
<p>image: image object of class ImageAICS.
Holds meta data at this moment, no image data.</p>
<p>get_meta: if true, retrieve meta data from file. Default is False</p>
</dd>
<dt>Output:</dt><dd><p>image: image with data and meta data as ImageAICS class</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.move_to_abs_pos">
<code class="sig-name descname">move_to_abs_pos</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stage_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">focus_drive_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">objective_changer_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">auto_focus_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">safety_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">safe_area</span><span class="o">=</span><span class="default_value">'Compound'</span></em>, <em class="sig-param"><span class="n">x_target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">z_target</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">z_focus_preset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reference_object_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">load</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">trials</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.move_to_abs_pos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.move_to_abs_pos" title="Permalink to this definition">¶</a></dt>
<dd><p>Move stage and focus drive to position (x, y, z)
in absolute system coordinates.</p>
<dl>
<dt>Input:</dt><dd><p>stage_id, focus_drive_id: strings to identify stage and focus drive</p>
<p>objective_changer_id: string to identify objective changer</p>
<p>safety_id: string to identify safety object</p>
<p>safe_area: name of safe area withing safety object
(default: ‘compound’ = combine all areas)</p>
<p>x_target, y_target: coordinates of stage after movement
(none = do not move stage)</p>
<p>z_target: coordinate for focus position after movement
(none = do not move focus, but engage auto-focus)</p>
<p>z_focus_preset: z position for focus before focus recall
to make autofocus more reliable. (Default: None, do not use feature)</p>
<p>reference_object_id: ID of object of Sample class used to correct for xyz
offset between different objectives</p>
<p>load: Move focus in load position before move. Default: True</p>
<p>trials: number of trials to retrieve z position before procedure is aborted</p>
</dd>
<dt>Ouput:</dt><dd><p>x_final, y_final, z_final: coordinates after move</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.reference_position">
<code class="sig-name descname">reference_position</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">find_surface</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">reference_object_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.reference_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.reference_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Included for parity with ZEN Microscopes.
Raises HardwareCommandNotDefinedError.</p>
<dl>
<dt>Input:</dt><dd><p>find_surface: if True auto-focus will try to find cover slip before
operator refocuses. Default: False</p>
<p>reference_object_id: ID of plate, plate holder, or other sample object
the hardware is initialized for. Used for setting up of autofocus</p>
<p>verbose: if True print debug information (Default = True)</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.remove_images">
<code class="sig-name descname">remove_images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.remove_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.remove_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all images from queue on data service.</p>
<dl class="simple">
<dt>Input:</dt><dd><p>communication_object: Object that connects to microscope specific software</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.save_image">
<code class="sig-name descname">save_image</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_path</span></em>, <em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">interactive</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.save_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.save_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Save last Microscope ImageAICS taken from within Microscope software.
Method adds file_path to meta data.</p>
<dl>
<dt>Input:</dt><dd><p>file_path: filename with path to save ImageAICS</p>
<p>image: image of class ImageAICS</p>
<p>interactive: if True, allow update of filename if it already exists</p>
</dd>
<dt>Output:</dt><dd><p>image: image of class ImageAICS</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.set_microscope">
<code class="sig-name descname">set_microscope</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">settings_dict</span><span class="o">=</span><span class="default_value">{}</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.set_microscope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.set_microscope" title="Permalink to this definition">¶</a></dt>
<dd><p>Set status flags for microscope.</p>
<dl class="simple">
<dt>Input:</dt><dd><dl class="simple">
<dt>settings_dict: dictionary {component_id: {settings}}</dt><dd><dl class="simple">
<dt>supported flags:</dt><dd><p>autofocus_id: {use_auto_focus: True/False}</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>Output:</dt><dd><p>new_settings_dict: return all current settings</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.setup_microscope_for_initialization">
<code class="sig-name descname">setup_microscope_for_initialization</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">component_object</span></em>, <em class="sig-param"><span class="n">experiment</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">before_initialization</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.setup_microscope_for_initialization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.setup_microscope_for_initialization" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup microscope before initialization of individual components.
Method starts and stops live image mode.</p>
<dl>
<dt>Input:</dt><dd><p>component_object: instance of component class</p>
<p>experiment: Name of experiment setting in ZEN blue used for microscope
initialization (e.g. used for live mode)</p>
<p>before_initialization: if True setup microscope, if False reset</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.stop_microscope">
<code class="sig-name descname">stop_microscope</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/hardware_control_3i.html#SpinningDisk3i.stop_microscope"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.hardware_control_3i.SpinningDisk3i.stop_microscope" title="Permalink to this definition">¶</a></dt>
<dd><p>Stop Microscope immediately in emergency situation</p>
<dl class="simple">
<dt>Input:</dt><dd><p>none</p>
</dd>
<dt>Output:</dt><dd><p>none</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-microscope_automation.slidebook.slidebook_experiment_info">
<span id="microscope-automation-slidebook-slidebook-experiment-info-module"></span><h2>microscope_automation.slidebook.slidebook_experiment_info module<a class="headerlink" href="#module-microscope_automation.slidebook.slidebook_experiment_info" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="microscope_automation.slidebook.slidebook_experiment_info.SlidebookExperiment">
<em class="property">class </em><code class="sig-prename descclassname">microscope_automation.slidebook.slidebook_experiment_info.</code><code class="sig-name descname">SlidebookExperiment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">experiment_path</span></em>, <em class="sig-param"><span class="n">experiment_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/slidebook_experiment_info.html#SlidebookExperiment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.slidebook_experiment_info.SlidebookExperiment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="microscope_automation.slidebook.slidebook_experiment_info.SlidebookExperiment.experiment_exists">
<code class="sig-name descname">experiment_exists</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/microscope_automation/slidebook/slidebook_experiment_info.html#SlidebookExperiment.experiment_exists"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#microscope_automation.slidebook.slidebook_experiment_info.SlidebookExperiment.experiment_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to check if the experiment name provided in the preference
file exists in the Slidebook software</p>
<dl class="simple">
<dt>Input:</dt><dd><p>none</p>
</dd>
<dt>Output:</dt><dd><p>a boolean indicating if the experiment exists or not</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-microscope_automation.slidebook">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-microscope_automation.slidebook" title="Permalink to this headline">¶</a></h2>
<p>Slidebook package for Microscope Automation.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Microscope Automation</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Hardware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hardware_components.html">hardware_components</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_control.html">hardware_control</a></li>
<li class="toctree-l1"><a class="reference internal" href="RS232.html">RS232</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup_microscope.html">setup_microscope</a></li>
</ul>
<p class="caption"><span class="caption-text">Samples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="correct_background.html">correct_background</a></li>
<li class="toctree-l1"><a class="reference internal" href="draw_plate.html">draw_plate</a></li>
<li class="toctree-l1"><a class="reference internal" href="find_well_center.html">find_well_center</a></li>
<li class="toctree-l1"><a class="reference internal" href="find_cells.html">find_cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_location_picker_pyqtgraph.html">interactive_location_picker_pyqtgraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="positions_list.html">positions_list</a></li>
<li class="toctree-l1"><a class="reference internal" href="samples.html">samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup_samples.html">setup_samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="tile_images.html">tile_images</a></li>
</ul>
<p class="caption"><span class="caption-text">Zeiss Microscopes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="connect_zen_blue.html">connect_zen_blue</a></li>
<li class="toctree-l1"><a class="reference internal" href="connect_zen_black.html">connect_zen_black</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_control_zeiss.html">hardware_control_zeiss</a></li>
<li class="toctree-l1"><a class="reference internal" href="write_zen_tiles_experiment.html">write_zen_tiles_experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="zen_experiment_info.html">zen_experiment_info</a></li>
</ul>
<p class="caption"><span class="caption-text">3i Microscopes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hardware_control_3i.html">hardware_control_3i</a></li>
<li class="toctree-l1"><a class="reference internal" href="connect_slidebook.html">connect_slidebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="slidebook_experiment_info.html">slidebook_experiment_info</a></li>
</ul>
<p class="caption"><span class="caption-text">General Methods</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="automation_exceptions.html">automation_exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="automation_messages_form_layout.html">automation_messages_form_layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="error_handling.html">error_handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_path.html">get_path</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_AICS.html">image_AICS</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_image_czi.html">load_image_czi</a></li>
<li class="toctree-l1"><a class="reference internal" href="meta_data_file.html">meta_data_file</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="microscope_automation.html">microscope_automation package</a></li>
<li class="toctree-l1"><a class="reference internal" href="preferences.html">preferences</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Allen Institute Contribution Agreement</a></li>
<li class="toctree-l1"><a class="reference internal" href="LICENSE.html">LICENSE</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="microscope_automation.html">microscope_automation package</a><ul>
      <li>Previous: <a href="microscope_automation.samples.html" title="previous chapter">microscope_automation.samples package</a></li>
      <li>Next: <a href="microscope_automation.zeiss.html" title="next chapter">microscope_automation.zeiss package</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Allen Institute.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/microscope_automation.slidebook.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>