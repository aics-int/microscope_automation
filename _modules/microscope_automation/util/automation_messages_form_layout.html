
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>microscope_automation.util.automation_messages_form_layout &#8212; Microscope Automation 0.0 documentation</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for microscope_automation.util.automation_messages_form_layout</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">QDialog boxes and other messages for Microscope Automation package based on formlayout</span>
<span class="sd">https://pypi.python.org/pypi/formlayout</span>
<span class="sd">http://pythonhosted.org/formlayout/index.html#</span>
<span class="sd">https://github.com/PierreRaybaut/formlayout</span>
<span class="sd">http://pyqt.sourceforge.net/Docs/PyQt4/</span>
<span class="sd">https://wiki.qt.io/PySide</span>

<span class="sd">Requires PyQt4 or PyQt5, set installed API below</span>

<span class="sd">Created on Jun 23, 2016</span>

<span class="sd">@author: winfriedw</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># select PyQT5 as QT_API</span>
<span class="c1"># make sure QT5 is installed on system</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="c1"># switch between different versions of PyQt depending on computer system</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;QT_API&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pyqt5&quot;</span>
    <span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtGui</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">PyQt4</span> <span class="kn">import</span> <span class="n">QtGui</span>  <span class="c1"># noqa</span>

    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;QT_API&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;pyqt&quot;</span>

<span class="c1"># from PySide import QtGui</span>
<span class="kn">from</span> <span class="nn">formlayout</span> <span class="kn">import</span> <span class="n">fedit</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="kn">import</span> <span class="nn">pandas</span>

<span class="c1"># create logger</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;microscope_automation&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="read_string"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.read_string">[docs]</a><span class="k">def</span> <span class="nf">read_string</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ask for user input and allows option to abort script.</span>

<span class="sd">    Input:</span>
<span class="sd">     title: Title of dialog box</span>

<span class="sd">     label: Text to display in front of sting input field</span>

<span class="sd">     default: default input</span>

<span class="sd">     return_code: if True, will return after cancel with code 0,</span>
<span class="sd">     otherwise will call sys.exit()</span>

<span class="sd">    Return:</span>
<span class="sd">     0: User selected to abort script</span>

<span class="sd">     1: User pressed ok</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datalist</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">default</span><span class="p">),</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Press ok when done.</span><span class="se">\n</span><span class="s2">Press cancel to abort script.&quot;</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">datalist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_code</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User terminated program&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>


<div class="viewcode-block" id="information_message"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.information_message">[docs]</a><span class="k">def</span> <span class="nf">information_message</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Displays information to user and allows option to abort script.</span>

<span class="sd">    Input:</span>
<span class="sd">     title: Title of dialog box</span>

<span class="sd">     message: Message that will be displayed</span>

<span class="sd">     return_code: if True, will return after cancel with code 0,</span>
<span class="sd">     otherwise will call sys.exit()</span>

<span class="sd">    Return:</span>
<span class="sd">     0: User selected to abort script</span>

<span class="sd">     1: User pressed ok</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datalist</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Press OK when ready.</span><span class="se">\n</span><span class="s2">Press cancel to abort script.&quot;</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">datalist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_code</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User terminated program&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="setup_message"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.setup_message">[docs]</a><span class="k">def</span> <span class="nf">setup_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Displays information about setup error and allows option to abort script.</span>

<span class="sd">    Input:</span>
<span class="sd">     message: Message that will be displayed</span>

<span class="sd">     return_code: if True, will return after cancel with code 0,</span>
<span class="sd">     otherwise will call sys.exit()</span>

<span class="sd">    Return:</span>
<span class="sd">     0: User selected to abort script</span>

<span class="sd">     1: User pressed ok</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datalist</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Press ok when done.</span><span class="se">\n</span><span class="s2">Press cancel to abort script.&quot;</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">datalist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Error in setup detected&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_code</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User terminated program&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="operate_message"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.operate_message">[docs]</a><span class="k">def</span> <span class="nf">operate_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ask user to operate microscope manually and allows option to abort script.</span>

<span class="sd">    Input:</span>
<span class="sd">     message: Message that will be displayed</span>

<span class="sd">     return_code: if True, will return after cancel with code 0,</span>
<span class="sd">     otherwise will call sys.exit()</span>

<span class="sd">    Return:</span>
<span class="sd">     0: User selected to abort script</span>

<span class="sd">     1: User pressed ok</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datalist</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Press ok when done.</span><span class="se">\n</span><span class="s2">Press cancel to abort script.&quot;</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">datalist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Please operate microscope&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_code</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User terminated program&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="check_box_message"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.check_box_message">[docs]</a><span class="k">def</span> <span class="nf">check_box_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">checkBoxList</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Ask user to operate microscope manually and allows option to abort script.</span>

<span class="sd">    Input:</span>
<span class="sd">     message: Message that will be displayed</span>

<span class="sd">     checkBoxList: list with check box names and settings in form:</span>
<span class="sd">      [(&#39;Choice 1&#39;, True), (&#39;Choice 2&#39;, False)</span>

<span class="sd">     return_code: if True, will return after cancel with code 0,</span>
<span class="sd">     otherwise will call sys.exit()</span>

<span class="sd">    Return:</span>
<span class="sd">     0: User selected to abort script</span>

<span class="sd">     new_check_box_list: User pressed ok result is updated checkBoxList</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datalist</span> <span class="o">=</span> <span class="n">checkBoxList</span> <span class="o">+</span> <span class="p">[</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Press ok when done. </span><span class="se">\n</span><span class="s2">Press cancel to abort.&quot;</span><span class="p">),</span>
    <span class="p">]</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">datalist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Please select&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_code</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User terminated program&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">boxLabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">checkBoxList</span><span class="p">]</span>
        <span class="n">new_check_box_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">boxLabels</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">new_check_box_list</span></div>


<div class="viewcode-block" id="error_message"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.error_message">[docs]</a><span class="k">def</span> <span class="nf">error_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">blocking</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Show error message and allows option to abort script.</span>

<span class="sd">    Input:</span>
<span class="sd">     message: Message that will be displayed</span>

<span class="sd">     return_code: if True, will return after cancel with code 0,</span>
<span class="sd">     otherwise will call sys.exit()</span>

<span class="sd">     blocking: if True use modal dialog for error reporting, otherwise print(message)</span>

<span class="sd">    Return:</span>
<span class="sd">     0: User selected to abort script</span>

<span class="sd">     1: User pressed ok</span>

<span class="sd">     -1: User pressed ok and selected &#39;Ignore&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">blocking</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">datalist</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="p">(</span>
                <span class="kc">None</span><span class="p">,</span>
                <span class="s2">&quot;Please perform the action.</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;Press ok when done.</span><span class="se">\n</span><span class="s2">Press cancel to abort.&quot;</span><span class="p">,</span>
            <span class="p">),</span>
            <span class="p">(</span><span class="s2">&quot;Ignore&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">datalist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">return_code</span><span class="p">:</span>
                <span class="k">return</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User terminated program&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="wait_message"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.wait_message">[docs]</a><span class="k">def</span> <span class="nf">wait_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interrupt script and wait for user to continue.</span>

<span class="sd">    Input:</span>
<span class="sd">     message: Message that will be displayed</span>

<span class="sd">     return_code: if True, will return after cancel with code 0,</span>
<span class="sd">     otherwise will call sys.exit()</span>

<span class="sd">    Return:</span>
<span class="sd">     0: User selected to abort script</span>

<span class="sd">     True: User pressed ok and want&#39;s to continue to wait after each image</span>

<span class="sd">     False: User pressed ok and want&#39;s to cancel wait times</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datalist</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Please perform the action.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Press ok when done.</span><span class="se">\n</span><span class="s2">Press cancel to abort.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;Continue to wait after next image&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">datalist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Continue?&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_code</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User terminated program&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>


<div class="viewcode-block" id="select_message"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.select_message">[docs]</a><span class="k">def</span> <span class="nf">select_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interrupt script and wait for user to continue.</span>

<span class="sd">    Input:</span>
<span class="sd">     message: Message that will be displayed</span>

<span class="sd">     count: number of collected positions</span>

<span class="sd">     return_code: if True, will return after cancel with code 0,</span>
<span class="sd">     otherwise will call sys.exit()</span>

<span class="sd">    Return:</span>
<span class="sd">     0: User selected to abort script</span>

<span class="sd">     resultDict: dictionary of form {&#39;Include&#39;: True/False, &#39;Continue&#39;: True/False}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">datalist</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span>
            <span class="kc">None</span><span class="p">,</span>
            <span class="s2">&quot;Please perform action(s) below.</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Press ok when done.</span><span class="se">\n</span><span class="s2">Press cancel to abort.&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;Include position in data acquisition.&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Number of collected positions: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;Continue collecting positions.&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
    <span class="p">]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">datalist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Select&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_code</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User terminated program&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resultDict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Include&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Continue&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
        <span class="k">return</span> <span class="n">resultDict</span></div>


<div class="viewcode-block" id="file_select_dialog"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.file_select_dialog">[docs]</a><span class="k">def</span> <span class="nf">file_select_dialog</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">file_pattern</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;List all files in directory and select one.</span>

<span class="sd">    Input:</span>
<span class="sd">     directory: path to directory with files</span>

<span class="sd">     file_pattern: string with regular expression.</span>
<span class="sd">     If file matches expression it will be pre-selected.</span>

<span class="sd">     return_code: if True, will return after cancel with code 0,</span>
<span class="sd">     otherwise will call sys.exit()</span>

<span class="sd">    Output:</span>
<span class="sd">     file_path: path to selected file</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># load all file names in directory dirPaht + date</span>
    <span class="c1"># check if directory exists</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Directory for .csv file with colony coordinates does not exist&quot;</span><span class="p">)</span>
    <span class="n">all_files</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">))</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># find all filenames that match</span>
        <span class="n">col_file_loc_series</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">file_pattern</span><span class="p">,</span> <span class="n">singleFile</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">singleFile</span> <span class="ow">in</span> <span class="n">all_files</span>
        <span class="p">]</span>
        <span class="n">col_file_loc_index</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">all_files</span><span class="p">[</span><span class="n">col_file_loc_series</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">])]</span>
        <span class="n">all_files</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_files</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">col_file_loc_index</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">all_files</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_files</span><span class="p">)</span>
    <span class="n">all_files</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">datalist</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Files:&quot;</span><span class="p">,</span> <span class="n">col_file_loc_index</span> <span class="o">+</span> <span class="n">all_files</span><span class="p">)]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">datalist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Select file?&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">return_code</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User terminated program&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">all_files</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="pull_down_select_dialog"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.pull_down_select_dialog">[docs]</a><span class="k">def</span> <span class="nf">pull_down_select_dialog</span><span class="p">(</span><span class="n">item_list</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Show all items from itemList in pulldown menu and allow user to select one item.</span>

<span class="sd">    Input:</span>
<span class="sd">     itemList: list of strings to display in pull down menu</span>

<span class="sd">     message: string with instructions to user</span>

<span class="sd">    Output:</span>
<span class="sd">     selected_item: item selected by user</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># create content of pull down menu</span>
    <span class="n">datalist</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Selection:&quot;</span><span class="p">,</span> <span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">item_list</span><span class="p">]))]</span>

    <span class="c1"># display dialog bos</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">datalist</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Selection&quot;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">message</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">stop_script</span><span class="p">()</span>
    <span class="n">selected_item</span> <span class="o">=</span> <span class="n">item_list</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">selected_item</span></div>


<div class="viewcode-block" id="value_calibration_form"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.value_calibration_form">[docs]</a><span class="k">def</span> <span class="nf">value_calibration_form</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="o">*</span><span class="n">form_fields</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Attribute selection dialog for value calibration</span>
<span class="sd">    Last result value will always be</span>
<span class="sd">    True or False for whether the value(s) were acceptable</span>

<span class="sd">    Input:</span>
<span class="sd">     title: title for the form</span>

<span class="sd">     comment: comment for the form</span>

<span class="sd">     form_fields: variable length argument list for all fields to be changed</span>

<span class="sd">    Output:</span>
<span class="sd">     result: contents of the calibration form</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">form_fields</span><span class="p">)</span> <span class="o">+</span> <span class="p">[(</span><span class="s2">&quot;Correct?&quot;</span><span class="p">,</span> <span class="n">default</span><span class="p">)]</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">fedit</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span></div>


<div class="viewcode-block" id="stop_script"><a class="viewcode-back" href="../../../microscope_automation.util.html#microscope_automation.util.automation_messages_form_layout.stop_script">[docs]</a><span class="k">def</span> <span class="nf">stop_script</span><span class="p">(</span><span class="n">message_text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_continue</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Script will stop all Microscope action immediately and</span>
<span class="sd">    ask user to stop execution of script or to continue.</span>

<span class="sd">    Input:</span>
<span class="sd">     message_text: Message to user explaining why processing should be stopped.</span>

<span class="sd">     allow_continue: if True, allow user to continue. Default: False</span>

<span class="sd">    Output:</span>
<span class="sd">     none if user selects &#39;Continue&#39;, otherwise calls sys.exit()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Microscope.stop_microscope()</span>
    <span class="k">if</span> <span class="n">allow_continue</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message_text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message_text</span> <span class="o">=</span> <span class="s2">&quot;If you want to abort script press ok.</span><span class="se">\n</span><span class="s2">otherwise Continue&quot;</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">information_message</span><span class="p">(</span><span class="s2">&quot;Exit script&quot;</span><span class="p">,</span> <span class="n">message_text</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">message_text</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">message_text</span> <span class="o">=</span> <span class="s2">&quot;Exit&quot;</span>
        <span class="n">con</span> <span class="o">=</span> <span class="n">information_message</span><span class="p">(</span><span class="s2">&quot;Exit script&quot;</span><span class="p">,</span> <span class="n">message_text</span><span class="p">,</span> <span class="n">return_code</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">con</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">con</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># logger.info(&#39;User aborted operation&#39;)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User aborted operation&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span></div>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../../index.html">Microscope Automation</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">README</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html#packaging-the-zip">Packaging the ZIP</a></li>
</ul>
<p class="caption"><span class="caption-text">Orchestrator</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../find_positions.html">find_positions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../microscope_automation.html">microscope_automation package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../write_zen_tiles_experiment.html">write_zen_tiles_experiment</a></li>
</ul>
<p class="caption"><span class="caption-text">Hardware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../hardware_components.html">hardware_components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hardware_control.html">hardware_control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hardware_control_3i.html">hardware_control_3i</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hardware_control_zeiss.html">hardware_control_zeiss</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../RS232.html">RS232</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../setup_microscope.html">setup_microscope</a></li>
</ul>
<p class="caption"><span class="caption-text">Samples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../correct_background.html">correct_background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../draw_plate.html">draw_plate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../find_well_center.html">find_well_center</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../find_cells.html">find_cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interactive_location_picker_pyqtgraph.html">interactive_location_picker_pyqtgraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../positions_list.html">positions_list</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../samples.html">samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../setup_samples.html">setup_samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tile_images.html">tile_images</a></li>
</ul>
<p class="caption"><span class="caption-text">Connectors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../connect_slidebook.html">connect_slidebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../connect_zen_blue.html">connect_zen_blue</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../connect_zen_black.html">connect_zen_black</a></li>
</ul>
<p class="caption"><span class="caption-text">Settings</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../meta_data_file.html">meta_data_file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../preferences.html">preferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../slidebook_experiment_info.html">slidebook_experiment_info</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zen_experiment_info.html">zen_experiment_info</a></li>
</ul>
<p class="caption"><span class="caption-text">Utility</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../automation_exceptions.html">automation_exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../automation_messages_form_layout.html">automation_messages_form_layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../error_handling.html">error_handling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../get_path.html">get_path</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../image_AICS.html">image_AICS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../load_image_czi.html">load_image_czi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software_state.html">software_state</a></li>
</ul>
<p class="caption"><span class="caption-text">Import Helpers</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../intelligent_imaging_innovations.html">3i Imports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../zeiss.html">Zeiss Imports</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../CONTRIBUTING.html">Allen Institute Contribution Agreement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../LICENSE.html">LICENSE</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  <li><a href="../../microscope_automation.html">microscope_automation</a><ul>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Allen Institute.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.4.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>